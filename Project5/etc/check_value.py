import numpy as np

# 1. Convolution 2D
correct_conv2d_out = np.array([[4.15602761, 1.71696586, 3.03274771],
                               [1.38663883, 4.34007508, 2.56793368],
                               [0.30468451, 7.06794329, 1.50587495]])

# 3. Convolution Layer
correct_conv_out = np.array([[[[-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5]],
  [[-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5]],
  [[-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5]]],
 [[[-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5],
   [-4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5, -4.5]],
  [[-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5],
   [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5]],
  [[-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5],
   [-2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5]]]])

correct_conv_dx = np.array([[[[-10.5,  0.   , -21.  ,-21.  ,-21.  ,-21.  ,-21.  ,-21.  ,-10.5 ,-21.  ],
                     [ 94.5,  89.25, 47.25, 47.25, 47.25, 47.25, 47.25, 47.25,-47.25, -42.  ],
                     [ 78.75, 52.5 , 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5 , 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5 , 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5 , 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5 , 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5 , 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 89.25, 52.5 , 68.25, 68.25, 68.25, 68.25, 68.25, 68.25, -21. , 15.75],
                     [-15.75, -36.75,   0.,    0.,    0.,    0.,    0.,    0., 15.75, 36.75]]],
                   [[[-10.5, 0., -21. ,-21. ,-21. ,-21. ,-21. ,-21. ,-10.5, -21.  ],
                     [ 94.5, 89.25, 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -47.25, -42.  ],
                     [ 78.75, 52.5, 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5, 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5, 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5, 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5, 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 78.75, 52.5, 47.25, 47.25, 47.25, 47.25, 47.25, 47.25, -31.5, -5.25],
                     [ 89.25, 52.5, 68.25, 68.25, 68.25, 68.25, 68.25, 68.25, -21. , 15.75],
                     [-15.75, -36.75,  0., 0.   , 0.   , 0.   , 0.   , 0.   , 15.75, 36.75]]]])

correct_conv_dW = [[[[-576., -576., -576.],
                     [-576., -576., -576.],
                     [-576., -576., -576.]]],
                   [[[-448., -448., -448.],
                     [-448., -448., -448.],
                     [-448., -448., -448.]]],
                   [[[-320., -320., -320.],
                     [-320., -320., -320.],
                     [-320., -320., -320.]]]]

correct_conv_db = np.array([-576., -448., -320.])

# 4. Pooling Layer
correct_pooled = np.array([[[[5., 10.],
                             [1., 11.]]]])
correct_d_pool = np.array([[[[1., 0., 0., 1.],
                             [0., 0., 0., 0.],
                             [0., 0., 1., 0.],
                             [0., 1., 0., 0.]]]])

# 5. FC Layer
correct_fc_forward = np.array([[1.03, -3.25],
                            [-0.99, 0.]])
correct_fc_backward = np.array([[5.75, -3.01],
                            [1.25, -1.]])
correct_fc_dW = np.array([[1., -3.],
                       [-3., 10.]])
correct_fc_db = np.array([-1, 4])

# 6. Softmax Layer
correct_sm = np.array([[2.48168930e-02, 6.72851458e-01, 3.02331649e-01],
                       [9.99831219e-01, 1.23388975e-04, 4.53922671e-05],
                       [1.38389653e-87, 3.72007598e-44, 1.00000000e+00],
                       [3.33333333e-01, 3.33333333e-01, 3.33333333e-01]])

correct_ce_loss = 1.5991806917017481
correct_d_softmax = np.array([[-0.25, 0.08333333, 0.08333333,  0.08333333],
                              [0.3, -0.32233333,  0.011, 0.011],
                              [ 0., 0., 0., 0.]])


# 7. CNN Classifier
correct_cnn_fc_dW = np.array([[-179.04592202, 179.04592202],
                     [-150.96010638, 150.96010638],
                     [-108.9403269 , 108.9403269 ],
                     [-193.04519741, 193.04519741],
                     [ -44.57223743,  44.57223743],
                     [ -87.23607903,  87.23607903],
                     [-154.16643209, 154.16643209],
                     [ -79.50729587,  79.50729587],
                     [-398.44060246, 398.44060246],
                     [-401.79891855, 401.79891855],
                     [-211.46894009, 211.46894009],
                     [-296.54992548, 296.54992548],
                     [-408.93935322, 408.93935322],
                     [-158.63057209, 158.63057209],
                     [-200.27736781, 200.27736781],
                     [-383.22595537, 383.22595537],
                     [-247.80352097, 247.80352097],
                     [   0.        ,   0.        ],
                     [   0.        ,   0.        ],
                     [   0.        ,   0.        ],
                     [   0.        ,   0.        ],
                     [   0.        ,   0.        ],
                     [   0.        ,   0.        ],
                     [   0.        ,   0.        ],
                     [   0.        ,   0.        ],
                     [   0.        ,   0.        ],
                     [   0.        ,   0.        ]])

correct_cnn_fc_db = np.array([-0.5, 0.5])

correct_cnn_conv1_dW =np.array([[[[146.58871726, 94.69691854],
                         [206.62833035, 160.88624054]]],
                       [[[  0.        , 0.        ],
                         [  0.        , 0.        ]]],
                       [[[248.20075612, 160.86011339],
                         [200.31389335, 218.74370646]]]])
correct_cnn_conv1_db = np.array([1.36616918, 0.        , 2.01081008])